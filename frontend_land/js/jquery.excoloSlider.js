/*
 * Excolo Slider - A simple jquery slider
 *
 * Examples and documentation at: 
 * http://excolo.github.io/Excolo-Slider/
 *
 * Author: Nikolaj Dam Larsen
 * Version: 1.1.0 (16-MAY-2014)
 *
 * Released under the MIT license
 * https://github.com/Excolo/ExcoloSlider/blob/master/LICENSE
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){var b;b=(function(){function c(d,e){this.elem=d;this.$elem=a(d);this.options=e;this.metadata=this.$elem.data("plugin-options")}return c})();b.prototype={defaults:{width:298,height:530,autoSize:true,touchNav:true,mouseNav:true,prevnextNav:true,prevnextAutoHide:true,pagerNav:true,startSlide:1,autoPlay:true,delay:0,interval:3000,repeat:true,playReverse:false,hoverPause:true,captionAutoHide:false,animationCssTransitions:true,animationDuration:500,animationTimingFunction:"linear",prevButtonClass:"slide-prev",nextButtonClass:"slide-next",activeSlideClass:"es-active",slideCaptionClass:"es-caption",pagerClass:"es-pager",},init:function(){var j,l,h,g,c,f,k,i,d,e;j=this;j.config=a.extend({},j.defaults,j.options,j.metadata);j.actionClick={action:false,x:0,y:0};j.currClick={x:0,y:0};j.data=a.data(j);a.data(j,"currentSlide",j.config.playReverse&&j.config.startSlide==1?j.$elem.children().length-1:j.config.startSlide-1);a.data(j,"nextSlide",j.data.currentSlide);a.data(j,"totalslides",j.$elem.children().length);a.data(j,"browserEnginePrefix",j._getBrowserEnginePrefix());a.data(j,"isPlaying",false);a.data(j,"isAnimating",false);a.data(j,"playPaused",false);a.data(j,"justTouched",false);a.data(j,"isMoving",false);a.data(j,"width",j.config.width);j.$elem.addClass("slider");j.$elem.css({position:"relative"});j.$elem.wrapInner("<div class='slide-wrapper'>",j.$elem).children();j.$elem.wrapInner("<div class='slide-container'>",a(".slide-wrapper",j.$elem)).children();j.$elem.wrapInner("<div class='slide-dragcontainer'>",a(".slide-container",j.$elem)).children();a(".slide-container",j.$elem).css({position:"relative"});e=a(".slide-dragcontainer",j.$elem);i=a(".slide-wrapper",j.$elem);d=i.children();if(j.config.prevnextNav){i.after("<div class='"+j.config.nextButtonClass+"'>");i.after("<div class='"+j.config.prevButtonClass+"'>");g=a("."+j.config.nextButtonClass,j.$elem);h=a("."+j.config.prevButtonClass,j.$elem);c=g.add(h);if(j.config.prevnextAutoHide){c.hide();j.$elem.hover(function(){c.fadeIn("fast")},function(){c.fadeOut("fast")})}h.on("click",function(m){j.previous()});g.on("click",function(m){j.next()});h.on("touchstart",function(m){m.stopPropagation()});g.on("touchstart",function(m){m.stopPropagation()})}if(j.config.pagerNav){j.$elem.append("<ul class='"+j.config.pagerClass+"'>");d.each(function(){a("<li />").appendTo(a("."+j.config.pagerClass,j.$elem)).attr("rel",a(this).index()).on("click",function(){a.data(j,"nextSlide",parseInt(a(this).attr("rel")));j._prepareslides(true);j._slide(true);j._manualInterference()})})}d.each(function(){f=a(this);k=f.data("plugin-slide-caption");if(k===undefined){return}if(this.tagName=="IMG"){f.wrap("<div>");f.after("<div class='"+j.config.slideCaptionClass+"'>");f.next().append(k)}else{f.append("<div class='"+j.config.slideCaptionClass+"'>");f.children().last().append(k)}if(j.config.captionAutoHide){a("."+j.config.slideCaptionClass,j.$elem).hide();j.$elem.hover(function(){a("."+j.config.slideCaptionClass,j.$elem).fadeIn("fast")},function(){a("."+j.config.slideCaptionClass,j.$elem).fadeOut("fast")})}});i.children().addClass("slide").css({position:"absolute",top:0,left:0,width:j.data.width,height:j.config.height,zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});l=d.height();i.css({position:"relative",left:0,height:l});a(".slide-container",j.$elem).css({width:j.data.width,overflow:"hidden",height:l});if(j.config.touchNav){e.on("touchstart",function(m){var n=m.originalEvent.touches[0];m.preventDefault();j._onMoveStart(n.pageX,n.pageY);j.actionClick.x=j.currClick.x=n.pageX;j.actionClick.y=j.currClick.y=n.pageY;j.actionClick.action=true;return m.stopPropagation()});e.on("touchmove",function(m){var n=m.originalEvent.touches[0];m.preventDefault();j.actionClick.action=false;j._onMove(n.pageX,n.pageY);j.currClick.x=n.pageX;j.currClick.y=n.pageY;return m.stopPropagation()});e.on("touchend",function(m){if((j.actionClick.action==true)&&(j.actionClick.x==j.currClick.x)&&(j.actionClick.y==j.currClick.y)){var n=e.find("."+j.config.activeSlideClass+" a, a."+j.config.activeSlideClass).attr("href");if((n!=undefined)&&(n!="")){window.location=n}}m.preventDefault();j._onMoveEnd();return m.stopPropagation()})}if(j.config.mouseNav){e.css("cursor","pointer");e.on("dragstart",function(m){return false});e.on("mousedown",function(m){j._onMoveStart(m.clientX,m.clientY);j.actionClick.x=m.clientX;j.actionClick.y=m.clientY;j.actionClick.action=false;a(window).attr("unselectable","on").on("selectstart",false).css("user-select","none").css("UserSelect","none").css("MozUserSelect","none");return m.stopPropagation()});a(window).on("mousemove",function(m){j._onMove(m.clientX,m.clientY);return m.stopPropagation()});a(window).on("mouseup",function(m){j._onMoveEnd();if((j.actionClick.x==m.clientX)&&(j.actionClick.y==m.clientY)){j.actionClick.action=true}a(window).removeAttr("unselectable").unbind("selectstart").css("user-select",null).css("UserSelect",null).css("MozUserSelect",null);return m.stopPropagation()});e.on("mouseup",function(m){if((j.actionClick.x==m.clientX)&&(j.actionClick.y==m.clientY)){j.actionClick.action=true}});e.on("click",function(m){if(j.actionClick.action!=true){m.stopPropagation();m.preventDefault()}})}if(j.config.autoSize){setTimeout(function(){j._resize()},50);a(window).resize(function(){return setTimeout(function(){j._resize()},50)})}j._prepareslides();j.gotoSlide(j.data.currentSlide);if(j.config.autoPlay){setTimeout(function(){j.start()},j.config.delay)}return this},previous:function(){var c,d;c=this;a.data(c,"slideDirection","previous");d=(c.data.nextSlide-1)%c.data.totalslides;if(!c.config.repeat&&(c.data.nextSlide-1)<0){if(c.config.playReverse){a.data(c,"playPaused",true);c.stop()}return}else{if(c.data.playPaused&&(c.data.nextSlide-1)>0){a.data(c,"playPaused",false);c.start()}}a.data(c,"nextSlide",d);return this._slide()},next:function(){var c,d;c=this;a.data(c,"slideDirection","next");d=(c.data.nextSlide+1)%c.data.totalslides;if(!c.config.repeat&&(c.data.nextSlide+1)>(c.data.totalslides-1)){if(!c.config.playReverse){a.data(c,"playPaused",true);c.stop()}return}else{if(c.data.playPaused&&(c.data.nextSlide+1)<(c.data.totalslides-1)){a.data(c,"playPaused",false);c.start()}}a.data(c,"nextSlide",d);return this._slide()},start:function(){var d,c,e;d=this;c=a(".slide-container",d.$elem);if(d.data.isPlaying&&d.data.playTimer){clearInterval(d.data.playTimer)}e=setInterval((function(){if(d.config.playReverse){d.previous()}else{d.next()}}),d.config.interval);a.data(d,"playTimer",e);if(d.config.hoverPause){c.unbind();c.hover(function(){a.data(d,"playPaused",true);return d.stop()},function(){a.data(d,"playPaused",false);return d.start()})}a.data(d,"isPlaying",true)},stop:function(){var d,c;d=this;c=a(".slide-container",d.$elem);clearInterval(d.data.playTimer);a.data(d,"playTimer",null);if(d.config.hoverPause&&!d.data.playPaused){c.unbind()}a.data(d,"isPlaying",false)},gotoSlide:function(i){var f,h,c,e,d,g;f=this;if(f.data.totalslides<=0){return}a.data(f,"nextSlide",(i)%f.data.totalslides);h=(i)%f.data.totalslides;a.data(f,"currentSlide",h);c=a(".slide-wrapper",f.$elem);e=c.children();d=c.children().eq(h);g=d.position().left;f._setActive(e,d);if(f.config.animationCssTransitions&&f.data.browserEnginePrefix){f._transition((-g),0)}else{c.css("left",-g)}f._alignSlides(g)},_manualInterference:function(){var c=this;if(c.data.isPlaying){c.stop();c.start()}},_prepareslides:function(h){var e,c,d,j,f,g;e=this;c=a(".slide-wrapper",e.$elem);d=c.children();j=e.data.width;f=Math.floor(e.data.totalslides/2);g=0;d.each(function(){a(this).css({display:"block",left:j*g,zIndex:10});g++;if(!h&&e.config.repeat&&g>f){g=e.data.totalslides%2?-f:-(f-1)}})},_onMoveStart:function(d,e){var c=this;if(!c.data.isMoving){a.data(c,"touchTime",Number(new Date()))}a.data(c,"touchedX",d);a.data(c,"touchedY",e);a.data(c,"isMoving",true);if(c.data.isPlaying){a.data(c,"playPaused",true);c.stop()}},_onMove:function(j,k){var e,c,d,f,h,i,g;e=this;if(!e.data.isMoving){return}c=a(".slide-wrapper",e.$elem);a.data(e,"scrolling",Math.abs(j-e.data.touchedX)<Math.abs(k-e.data.touchedY));if(!e.data.scrolling&&!e.data.isAnimating){d=c.children().eq(e.data.nextSlide);f=d.position().left;h=e.data.browserEnginePrefix.css;i=j-e.data.touchedX;g=e.data.width*0.1;if(!e.config.repeat){if(e.data.currentSlide<=0&&-i<-g){i=g}else{if(e.data.currentSlide>=(e.data.totalslides-1)&&-i>g){i=-g}}}e._transition(-f+i,0)}},_onMoveEnd:function(){var e,c,d,g,f,i,h;e=this;if(!e.data.isMoving){return}c=a(".slide-wrapper",e.$elem);a.data(e,"justTouched",true);d=c.children().eq(e.data.nextSlide);g=d.position().left;f=e.data.width*0.5;i=e.data.width*0.1;h=(Number(new Date())-e.data.touchTime<250);if(!e.config.repeat&&(c.position().left<-(g)&&e.data.currentSlide>=(e.data.totalslides-1)||c.position().left>(-g)&&e.data.currentSlide<=0)){e._transition((-g),0.15)}else{if(c.position().left>(-g+f)||(c.position().left>(-g+i)&&h)){this.previous()}else{if(c.position().left<-(g+f)||(c.position().left<-(g+i)&&h)){this.next()}else{e._transition((-g),0.15)}}}e._alignSlides(g);a.data(e,"isMoving",false);a.data(e,"justTouched",false);if(e.data.playPaused){e.start()}},_alignSlides:function(j){var f,c,e,d,k,o,g,h,m,n,l;f=this;if(!f.config.repeat){return}c=a(".slide-wrapper",f.$elem);e=c.children();if(j===undefined){d=c.children().eq(f.data.nextSlide);j=d.position().left}j=Math.round(j,0);k=Math.ceil(f.data.totalslides/2);o=f.data.width;g=0;e.each(function(){var i=Math.round(a(this).position().left);if(i>Math.round(j-o)){g++}});h=k-g;if(h<0){h=f.data.totalslides%2==0?h+1:h}for(m=0;m<Math.abs(h);m++){n=[].reduce.call(e,function(p,i){return a(p).offset().left<a(i).offset().left?p:i});l=[].reduce.call(e,function(p,i){return a(p).offset().left>a(i).offset().left?p:i});if(h>0){a(n).css("left",Math.round(a(l).position().left+o))}else{a(l).css("left",Math.round(a(n).position().left-o))}}},_slide:function(i){var f,h,c,e,d,g;f=this;h=f.data.nextSlide;c=a(".slide-wrapper",f.$elem);e=c.children();d=c.children().eq(h);g=Math.round(d.position().left);f._setActive(e,d);if(!i){f._alignSlides(g)}a.data(f,"isAnimating",true);if(f.config.animationCssTransitions&&f.data.browserEnginePrefix){f._transition((-g),(f.data.justTouched?0.5:1));c.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){a.data(f,"currentSlide",h);c.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd");if(i){f._alignSlides(g)}})}else{c.stop().animate({left:-g},f.config.animationDuration,function(){a.data(f,"currentSlide",h);a.data(f,"isAnimating",false);a.data(f,"justTouched",false)})}},_transition:function(g,f){var d,c,h,j,e,i;d=this;c=a(".slide-wrapper",d.$elem);if(f===undefined||f<0){f=1}h=d.data.browserEnginePrefix.css;j=h+"Transform";e=h+"TransitionDuration";i=h+"TransitionTimingFunction";c[0].style[e]=(d.config.animationDuration*f)+"ms";c[0].style[i]=d.config.animationTimingFunction;c[0].style[j]="translateX("+g+"px)";c.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){a.data(d,"isAnimating",false);a.data(d,"justTouched",false);c.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})},_setActive:function(d,c){var f=this,e,g;e=f.config.activeSlideClass;d.removeClass(e);c.addClass(e);if(f.config.pagerNav){g=a("."+f.config.pagerClass,f.$elem);g.children().removeClass("act");g.find("[rel="+c.index()+"]").addClass("act")}},_resize:function(){var c,f,g,e,d;c=this;if(c.data.isPlaying){a.data(c,"playPaused",true);c.stop()}f=c.$elem.width();g=c.config.height/c.config.width;e=f*g;a.data(c,"width",f);a(".slide",c.$elem).css({width:f,height:e});d=a(".slide-wrapper",c.$elem).children().height();a(".slide-wrapper",c.$elem).css({height:d});a(".slide-container",c.$elem).css({width:f,height:d});if(c.data.playPaused){a.data(c,"playPaused",false);c.start()}c._prepareslides();c.gotoSlide(c.data.currentSlide)},_getBrowserEnginePrefix:function(){var d,e,c;d="Transition";e=["Moz","Webkit","Khtml","O","ms"];c=0;while(c<e.length){if(typeof document.body.style[e[c]+d]==="string"){return{css:e[c]}}c++}return false}};b.defaults=b.prototype.defaults;a.fn.excoloSlider=function(c){return this.each(function(){new b(this,c).init()})}}));
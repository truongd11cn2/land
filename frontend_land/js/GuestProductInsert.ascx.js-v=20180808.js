var vip4=4;var vip0=0;var cityList=[];var hdbProductType=$("#divProductType").AdvanceHiddenDropbox({id:"divProductTypeOptions",hddValue:"hddProductType"});var hdbProductCate=$("#divProductCate").AdvanceHiddenDropbox({id:"divProductCateOptions",hddValue:"hddProductCate"});var hdbCity=$("#divCity").AdvanceHiddenDropbox({id:"divCityOptions",hddValue:"hddCity"});var hdbDistrict=$("#divDistrict").AdvanceHiddenDropbox({id:"divDistrictOptions",hddValue:"hddDistrict"});var hdbWard=$("#divWard").AdvanceHiddenDropbox({id:"divWardOptions",hddValue:"hddWard"});var hdbStreet=$("#divStreet").AdvanceHiddenDropbox({id:"divStreetOptions",hddValue:"hddStreet"});var hdbProject=$("#divProject").AdvanceHiddenDropbox({id:"divProjectOptions",hddValue:"hddProject"});function VipChange(){var b=$("#ddlVipType").children("option:selected").val();var a="";switch(b){case"5":a='<strong>Tin thường</strong>: Là loại tin đăng bằng chữ <font color="#009AD2">màu xanh</font>, khung <font color="#009AD2">màu xanh</font>';break;case"4":a="<strong>Vip ưu đãi</strong>: Là loại tin được hiển thị trong vòng 3 tháng, mỗi tuần sẽ được up tin tự động 1 lần. Tuần đầu tiên sẽ được hiển thị dưới hình thức VIP 2, các tuần tiếp theo hiển thị hình thức tin thường";break;case"3":a='<strong>Tin Vip 3</strong>: Là loại tin đăng bằng chữ <font color="#FF6600">thường màu cam,</font> khung <font color="#FF6600">màu cam</font> và luôn nằm dưới tin Vip 2 nhưng luôn luôn hiển thị trên tin thường.';break;case"2":a='<strong>Tin Vip 2</strong>: Là loại tin đăng bằng chữ <font color="#FF6600"><strong>IN HOA MÀU CAM</strong></font>, khung <font color="#FF6600"><strong>màu cam</strong></font>, nằm bên dưới tin VIP 1 và ở trên các tin vip 3';break;case"1":a='<strong>Tin Vip 1</strong>: Là loại tin được đăng tiêu đề bằng chữ <font color="#DF1B23"> <strong>IN HOA MÀU ĐỎ</strong></font>, khung <font color="#DF1B23"><strong>màu đỏ,</strong></font> nằm bên dưới tin VIP ĐẶC BIỆT và ở trên các tin vip 2';break;case"0":a='<strong>Vip đặc biệt</strong>: Là loại tin được đăng tiêu đề bằng chữ <font color="#DF1B23"> <strong>IN HOA MÀU ĐỎ</strong></font>, khung <font color="#DF1B23"><strong>màu đỏ,</strong></font> hiển thị ở top đầu trang tin và được hưởng nhiều ưu tiên nhất';break}$("#vip_cofig_info_explain").html(a);$("#vip_cofig_info_explain").show()}function LoadProductType(){var a=hdbProductType.GetValue();var b='<li class="advance-options" vl="0">-- Hình thức --</li>';for(var c=0;c<cateList.length;c++){b+='<li class="advance-options" vl="'+cateList[c].id+'">'+cateList[c].name+"</li>"}hdbProductType.UpdateOptions(b);hdbProductType.SetValue(a)}function LoadVipType(){for(var a=0;a<vipTypeList.length;a++){if(a==0){$("#ddlVipType").append('<option value="'+vipTypeList[a].id+'">'+vipTypeList[a].name+"</option>")}else{$("#ddlVipType").append('<option value="'+vipTypeList[a].id+'">'+vipTypeList[a].name+"</option>")}}}function LoadProductCate(f){for(var d=0;d<cateList.length;d++){var c=cateList[d];if(c.id==f){var a='<li class="advance-options" vl="0">-- Phân mục --</li>';var b=hdbProductCate.GetValue();for(var e=0;e<c.children.length;e++){a+='<li class="advance-options" vl="'+c.children[e].id+'">'+c.children[e].name+"</li>"}hdbProductCate.UpdateOptions(a);hdbProductCate.SetValue(b);$("#ddlPriceType").html("");for(var e=0;e<c.prices.length;e++){if(c.id==38&&(c.prices[e].id==3||c.prices[e].id==4||c.prices[e].id==5||c.prices[e].id==8||c.prices[e].id==9)||c.id==49&&(c.prices[e].id==3||c.prices[e].id==4)){continue}$("#ddlPriceType").append('<option value="'+c.prices[e].id+'">'+c.prices[e].name+"</option>")}}}}function LoadCity(){var b=hdbCity.GetValue();var a='<li class="advance-options" vl="">-- Tỉnh/thành phố --</li>';for(var c=0;c<cityList.length;c++){a+='<li class="advance-options" vl="'+cityList[c].code+'">'+cityList[c].name+"</li>"}hdbCity.UpdateOptions(a);hdbCity.SetValue(b)}function LoadDistrict(d){var b='<li class="advance-options" vl="0">-- Quận/huyện --</li>';var a=hdbDistrict.GetValue();if(d.length>0){for(var e=0;e<cityList.length;e++){var c=cityList[e];if(c.code==d){for(var f=0;f<c.district.length;f++){b+='<li class="advance-options" vl="'+c.district[f].id+'">'+c.district[f].name+"</li>"}}}}hdbDistrict.UpdateOptions(b);hdbDistrict.SetValue(a);LoadWard(d,hdbDistrict.GetValue())}function LoadWard(q,r){var g=hdbWard.GetValue();var f=hdbStreet.GetValue();var e=hdbProject.GetValue();var d=hdbProductCate.GetValue();for(var h=0;h<cityList.length;h++){if(cityList[h].code==q){for(var l=0;l<cityList[h].district.length;l++){if(r==cityList[h].district[l].id){var c='<li class="advance-options" vl="0">-- Phường/xã --</li>';for(var o=0;o<cityList[h].district[l].ward.length;o++){c+='<li class="advance-options" vl="'+cityList[h].district[l].ward[o].id+'" rel="'+cityList[h].district[l].ward[o].pre+'">'+(cityList[h].district[l].ward[o].pre.length>0?cityList[h].district[l].ward[o].pre+" ":"")+cityList[h].district[l].ward[o].name+"</li>"}hdbWard.UpdateOptions(c);hdbWard.SetValue(g);var b='<li vl="0" class="advance-options">-- Đường/phố --</li>';for(var o=0;o<cityList[h].district[l].street.length;o++){b+='<li vl="'+cityList[h].district[l].street[o].id+'" rel="'+cityList[h].district[l].street[o].pre+'" class="advance-options">'+(cityList[h].district[l].street[o].pre.length>0?cityList[h].district[l].street[o].pre+" ":"")+cityList[h].district[l].street[o].name+"</li>"}hdbStreet.UpdateOptions(b);hdbStreet.SetValue(f);var a='<li vl="0" class="advance-options">-- Dự án --</li>';for(var o=0;o<cityList[h].district[l].project.length;o++){var k=d==0;if(d>0){for(var p=0;p<cityList[h].district[l].project[o].cats.length;p++){if(cityList[h].district[l].project[o].cats[p]==d){k=true;break}}}if(k||true){a+='<li class="advance-options" vl="'+cityList[h].district[l].project[o].id+'" lat="'+cityList[h].district[l].project[o].lat+'" lng="'+cityList[h].district[l].project[o].lng+'" street="'+cityList[h].district[l].project[o].street+'" ward="'+cityList[h].district[l].project[o].ward+'">'+cityList[h].district[l].project[o].name+"</li>"}}hdbProject.UpdateOptions(a);hdbProject.SetValue(e)}}}}}function LoadDirection(){for(var a=0;a<directionList.length;a++){$("#ddlHomeDirection").append('<option value="'+directionList[a].value+'">'+directionList[a].name+"</option>");$("#ddlBaconDirection").append('<option value="'+directionList[a].value+'">'+directionList[a].name+"</option>")}}function setTotalRePrice(){var c=hdbProductType.GetValue();var b=$("#txtPrice").val();var a=$("#txtArea").val();var d=$("#ddlPriceType").val();$.ajax({type:"GET",url:"https://content.batdongsan.com.vn/trang-ca-nhan/HandlerWeb/ProductEditServiceHandler.ashx",data:{type:"GetTotalPrice",cost:b,prType:c,area:a,priceCode:d},dataType:"html",success:function(e){if(e!=null){$("#_totalPrice").html(e)}}})}function GetAbsCost(e){var c=new Date();var d=new Date(VNDateTimeToUTCDateTime($("#txtStartDate").val(),"/"));var b=new Date(VNDateTimeToUTCDateTime($("#txtEndDate").val(),"/"));d.setHours(c.getHours());d.setMinutes(c.getMinutes());d.setSeconds(c.getSeconds());b.setHours(c.getHours());b.setMinutes(c.getMinutes());b.setSeconds(c.getSeconds());if(d>b){var f=b;b=d;d=f;$("#txtEndDate").val(UTCDateTimeToVNDateTime(b,"/"));$("#txtStartDate").val(UTCDateTimeToVNDateTime(d,"/"))}var g=GetTotalDay(d,b);$(".product-totaldate span").text(g+" ngày");var h=parseInt($("#ddlVipType").val());var a=0;if(h==vip4){$(".product-unitprice span").text(GetMoneyText(parseFloat(unitPriceListNew[h])*1000));a=unitPriceListNew[h]}else{$(".product-unitprice span").text(GetMoneyText(parseFloat(unitPriceListNew[h])*1000)+"/Ngày");a=g*unitPriceListNew[h]}$("#lblPrice").html(GetMoneyText(Math.round(a*1000)));$("#lblVAT").html(GetMoneyText(Math.round((a*1.1-a)*1000)));a=Math.round(a*1.1*1000);$("#lblCost").html(GetMoneyText(a))}function ResetEndDate(){if($("#txtStartDate").val().length==0){$("#txtStartDate").val(UTCDateTimeToVNDateTime(new Date(),"/"))}if($("#txtEndDate").val().length==0){var g=new Date();g.setMonth(g.getMonth()+1);$("#txtEndDate").val(UTCDateTimeToVNDateTime(g,"/"))}var f=new Date(VNDateTimeToUTCDateTime($("#txtStartDate").val(),"/"));var a=new Date(VNDateTimeToUTCDateTime($("#txtEndDate").val(),"/"));if($("#ddlVipType").val()==(vip4)+""){$("#txtEndDate").attr("disabled","true");var b=new Date(f);b.setMonth(b.getMonth()+3);$("#txtEndDate").val(UTCDateTimeToVNDateTime(b,"/"));return}else{if($("#txtEndDate").attr("disabled")!=undefined){var b=new Date(f);b.setMonth(b.getMonth()+1);$("#txtEndDate").val(UTCDateTimeToVNDateTime(b,"/"))}$("#txtEndDate").removeAttr("disabled")}var c=new Date(f);var e=new Date(f);c.setMonth(c.getMonth()+6);var d=new Date(a);if($("#ddlVipType").val()=="0"){e.setDate(e.getDate()+10);d.setDate(d.getDate()-10)}else{e.setDate(e.getDate()+7);d.setDate(d.getDate()-7)}if(d<new Date()){d=new Date();a=e;$("#txtEndDate").val(UTCDateTimeToVNDateTime(a,"/"))}$("#txtEndDate").datepicker("option","maxDate",c);$("#txtEndDate").datepicker("option","minDate",e);$("#txtStartDate").datepicker("option","maxDate",d)}function showMessage(a,b){if($(a).parent().find(".errorMessage").length>0){$(a).parent().find(".errorMessage").html(b);$(a).parent().find(".errorMessage").show()}}function hideMessage(a){if($(a).parent().find(".errorMessage").length>0){$(a).parent().find(".errorMessage").hide()}}var focused=false;function setFocus(a){if(focused==false){focused=true;$(a).focus()}}function CountLimitChar(e,a,c){if(a==undefined){a=0}if(c==undefined){c=0}var d=$(e).attr("maxlength")-($(e).val().trim().length+a);if(d<0){d=0}var b="#055699";if(($(e).val().trim().length+a)<$(e).attr("minlength")||($(e).val().trim().length+a)>$(e).attr("maxlength")){b="red";if(c==1){$(e).focus();$(e).parent().find(".errorMessage").show().html('<p style="color: red">Vui lòng nhập tiêu đề tin đăng của bạn. Tối thiểu là '+$(e).attr("minlength")+" ký tự và tối đa là "+$(e).attr("maxlength")+" ký tự.</p>")}}else{$(e).parent().find(".errorMessage").hide()}if($("."+$(e).attr("id")+"_count").length<=0){$(e).after('<span class="'+$(e).attr("id")+'_count" style="float: left;color: '+b+'; margin-left: 10px;">'+d+"</span>")}else{$("."+$(e).attr("id")+"_count").attr("style","float: left;margin-left: 10px;color: "+b);$("."+$(e).attr("id")+"_count").html(d)}}function HideOptions(){if(hdbProductCate.GetValue()==324||hdbProductCate.GetValue()==326){$(".spMatTien").hide();$(".spDuongVao").hide();$(".spSoTang").hide();$(".spSoPhongNgu").show();$(".spToilet").show();$(".spBanCong").show();$(".spNoiThat").show()}else{if(hdbProductType.GetValue()==38&&hdbProductCate.GetValue()==40||hdbProductCate.GetValue()==283){$(".spSoPhongNgu").hide();$(".spSoTang").hide();$(".spToilet").hide();$(".spBanCong").hide();$(".spNoiThat").hide();$(".spMatTien").show();$(".spDuongVao").show()}else{if(hdbProductCate.GetValue()==45||hdbProductCate.GetValue()==53){$(".spSoPhongNgu").hide();$(".spSoTang").hide();$(".spBanCong").hide();$(".spMatTien").show();$(".spDuongVao").show();$(".spToilet").show();$(".spNoiThat").show()}else{if(hdbProductType.GetValue()==49&&(hdbProductCate.GetValue()==50||hdbProductCate.GetValue()==55)){$(".spSoPhongNgu").hide();$(".spMatTien").show();$(".spDuongVao").show();$(".spSoTang").show();$(".spToilet").show();$(".spBanCong").show();$(".spNoiThat").show()}else{$(".spMatTien").show();$(".spDuongVao").show();$(".spSoPhongNgu").show();$(".spSoTang").show();$(".spToilet").show();$(".spBanCong").show();$(".spNoiThat").show()}}}}}function registerEventForBackMail(){showHideReceiEmail();$("#txtBrEmail").keyup(function(){showHideReceiEmail()});$("#txtBrEmail").on("input propertychange",function(){showHideReceiEmail()});$("#lblchkReceiEmail").click(function(){if(!IsEmail($("#txtBrEmail"))){alert("Email không đúng, mời bạn vui lòng nhập email.");$("#txtBrEmail").focus()}})}function showHideReceiEmail(){if(IsEmail($("#txtBrEmail"))){$("#chkReceiEmail").prop("disabled",false)}else{$("#chkReceiEmail").prop("disabled",true);$("#chkReceiEmail").prop("checked",false)}}function IsEmail(a){var b=$(a).val();var c=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}(.[a-zA-Z]{2,6}){0,1}$/;if(b!=""){if(c.test(b)){return true}}return false}function isNumberKey(b){var a=(b.which)?b.which:event.keyCode;if(a>31&&(a<48||a>57)){return false}return true}function GetProjectIdInText(c){if(c.length>0){c=c.toLowerCase();var b=hdbProject.GetOptions();if(b.length>0){for(var a=0;a<b.length;a++){if(b[a].value!=""&&b[a].value!="0"){if(c.indexOf(b[a].text.toLowerCase())!=-1){return b[a].value}}}}}return"0"}var listCateAllowFocus=["324","325","40","326","50"];function focusProjectByDesciption(){var a=hdbProductCate.GetValue();if(a!=undefined&&a!=""&&a!="0"&&$.inArray(a,listCateAllowFocus)!=-1){var b=GetProjectIdInText($("#txtProductTitle").val());if(b=="0"){b=GetProjectIdInText($("#txtDescription").val())}if(b!="0"){hdbProject.SetValue(b);LoadAutoAddress();ShowLocation()}}}function _getImageSrc(b,c){var a=b.split(".");year=a[1].substring(0,4);month=a[1].substring(4,6);day=a[1].substring(6,8);if(c!=""){return filesv+"/resize/"+c+"/temp/"+year+"/"+month+"/"+day+"/"+a[1]+"."+a[2]}else{return filesv+"/temp/"+year+"/"+month+"/"+day+"/"+a[1]+"."+a[2]}}function ShowPreview(f){if(SubmitForm(true)==false){$("#finalError").html("Có thông tin bị lỗi. bạn cần hoàn thành hết các nội dung cần thiết trước khi xem trước tin");return}else{$("#finalError").html("")}if(f===undefined||f==null){f=window.open()}if(f==null){return}var a="https://content.batdongsan.com.vn";var b="";b+='<link href="'+a+'/Scripts/pannellum/pannellum.css" type="text/css" rel="stylesheet" />';b+='<link href="'+a+'/Scripts/pannellum/general360.css" type="text/css" rel="stylesheet" />';b+='<link href="'+a+'/Scripts/pannellum/Img360.css" type="text/css" rel="stylesheet" />';b+='<link href="'+a+'/Scripts/pannellum/Swiper-2.7.6/idangerous.swiper.css" type="text/css" rel="stylesheet" />';b+='<link href="'+a+'/App_Themes/Home/Mapv1.css" rel="stylesheet" />';b+='<link rel="stylesheet" type="text/css" href="'+a+'/css/fontawesome/css/font-awesome.min.css" media="all" />';b+='<link rel="stylesheet" type="text/css" href="'+a+'/css/style.css?v=147" media="all" />';b+='<script type="text/javascript" src="'+a+'/Scripts/jquery-1.7.2.min.js?v=147"></script>';b+='<script type="text/javascript" src="'+a+'/Scripts/common.js?v=147"></script>';b+='<script type="text/javascript" src="'+a+'/Scripts/pannellum/pannellum.js"></script>';b+='<script type="text/javascript" src="'+a+'/Scripts/pannellum/Img360.js"></script>';b+='<script type="text/javascript" src="'+a+'/Scripts/pannellum/Swiper-2.7.6/idangerous.swiper.min.js"></script>';b+='<script type="text/javascript">var mapHostUrl  = "https://apimap.batdongsan.com.vn";</script>';b+='<style type="text/css">.MapProductDetail .utilityform div label{white-space: inherit;}</style>';b+='<div class="site-center"><div class="body-left"><div id="product-detail"><div class="pm-title"><h1>'+$("#txtProductTitle").val()+'</h1></div><div class="kqchitiet"><span class="diadiem-title mar-right-15"><b>Khu vực:</b> <a href="https://content.batdongsan.com.vn/">'+hdbProductCate.GetText()+" tại "+hdbDistrict.GetText()+"</a> - "+hdbCity.GetText()+'</span><span style="display: inline-block;"><span class="gia-title mar-right-15"><b>Giá:</b><strong>'+($("#ddlPriceType").children().length>0&&$("#ddlPriceType").val()!="0"?$("#txtPrice").val()+" "+$("#ddlPriceType option:selected").text():"Thỏa thuận")+'</strong></span><span class="gia-title"><b>Diện tích:</b><strong>'+($("#txtArea").val().length>0?$("#txtArea").val()+"m²":"Không xác định")+"</strong></span></span></div>";b+='<div class="pm-mota">Thông tin mô tả</div><div class="pm-content stat">'+$("#txtDescription").val().replace(/(\n)/g,"<br/>")+"</div>";b+='<div class="pm-middle-content">';var d=[];var e=[];$(".imgthumb").each(function(){if(($(this).attr("rel")!=undefined)&&!$(this).next().find("span").hasClass("fa-check")){d.push($(this).attr("rel"))}if(($(this).attr("rel")!=undefined)&&$(this).next().find("span").hasClass("fa-check")){e.push([$(this).attr("rel"),$(this).next().next().children("textarea").val()])}});if(d.length>0||e.length>0){b+='<ul class="detail-more-info">';if(d.length>0){b+='<li><a href="javascript:void(0);" onclick="showPhoto(this)" rel="nofollow" class="active" title="Xem Ảnh"><span>Xem Ảnh</span></a></li>'}if(e.length>0){b+='<li runat="server" id="liImg360"><a href="javascript:void(0);" onclick="show360(this);" rel="nofollow" class="view-360" title="Xem Ảnh 360"><span>Xem ảnh 360</span></a></li>'}b+='<li><a href="javascript:void(0);" onclick="showMap(this)" rel="nofollow" class="view-map" title="Xem Bản đồ"><span>Xem Bản đồ</span></a></li></ul>'}else{b+='<a href="javascript:void(0);" onclick="showMapInfo(this)" rel="nofollow" class="view-map-button" title="Xem Bản đồ"><img src="https://file4.batdongsan.com.vn/images/Product/Maps/xembando-v2.jpg" width="119" height="27" alt="Xem Bản đồ" /></a>'}if(d.length>0){b+='<div class="img-map"><div id="photoSlide" class="photo" style="position: relative;"><div id="divPhotoActive" class="show-img" style="display: table-row; cursor: pointer; height: 510px;"><div style="display: table-cell; vertical-align: middle; min-height: 326px; width:745px; border: 0px; text-align: center"><img src="'+_getImageSrc(d[0],"745x510")+'" style="width: auto; height: auto;" id="imgSlide1">';if(d.length>1){b+='<img style="width: auto; height: auto; display: none;" id="imgSlide2" src="'+_getImageSrc(d[1],"745x510")+'">'}b+='</div></div><div id="autoplay" ac="manual"><span>Xem tự động</span></div><div class="list-img"><ul id="thumbs">';for(var c=0;c<d.length;c++){b+='<li class="'+(c==0?"current":"")+'"><img onmouseover="this.style.cursor=\'pointer\'" src="'+_getImageSrc(d[c],"80x60")+'"></li>'}b+='</ul></div><img src="https://file4.batdongsan.com.vn/images/thumb-back1.png" class="slideshow-icon-back" id="icon-back"><img src="https://file4.batdongsan.com.vn/images/thumb-next1.png" class="slideshow-icon-next" id="icon-next"></div>'}if(e.length>0){b+='<div id="photo360" class="group-img360" clientidmode="Static" style="display:none;">';b+='   <div class="view-img360">';b+='       <div id="divPhoto360Active" class="show-img">';b+='           <div class="top-controls">';b+='               <span id="btnCloseFullscreen" class="close-popup360"></span>';b+='               <ul class="nav-img360">';b+="                   <li>";b+='                       <span class="nav" id="zoom-in">';b+='                           <i class="icon360-zoomin"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="zoom-out">';b+='                           <i class="icon360-zoomout"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="pan-left">';b+='                           <i class="icon360-prev"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="pan-right">';b+='                           <i class="icon360-next"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="pan-up">';b+='                           <i class="icon360-up"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="pan-down">';b+='                           <i class="icon360-down"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="auto-rotate">';b+='                           <i class="icon360-reload"></i>';b+="                       </span>";b+="                   </li>";b+="                   <li>";b+='                       <span class="nav" id="fullscreen">';b+='                           <i class="icon360-viewfull"></i>';b+="                       </span>";b+="                   </li>";b+="               </ul>";b+="           </div>";b+="";b+="       </div>";b+='       <div id="titImg360" class="tit-img"></div>';b+="   </div>";b+='   <div class="list-img">';b+='       <ul id="thumbs" class="thumbs360">';for(var c=0;c<e.length;c++){b+='       <li class="'+(c==0?"current":"")+' swiper-slide" data-order="'+c+'">';b+="           <img onmouseover=\"this.style.cursor='pointer'\"";b+='               full="'+_getImageSrc(e[c][0],"")+'"';b+='               title="'+e[c][1]+'"';b+='               src="'+_getImageSrc(e[c][0],"260x220")+'" />';b+='           <span class="tit360">';b+='               <i class="icon360-globe"></i>';b+="           </span>";b+="       </li>"}b+="       </ul>";b+="   </div>";b+="</div>"}b+='<div id="googleMap" class="MapProductDetail" style="display: none"><div class="utilityform"><span class="utility-header">Chọn bán kính</span><div class="utilityradius"><label for="rad200"><input type="radio" name="radius" checked="checked" id="rad200" value="200">200 m</label><label for="rad500"><input type="radio" name="radius" id="rad500" value="500">500 m</label><label for="rad1000"><input type="radio" name="radius" id="rad1000" value="1000">1 km</label><label for="rad2000"><input type="radio" name="radius" id="rad2000" value="2000">2 km</label><label for="rad5000"><input type="radio" name="radius" id="rad5000" value="5000">5 km</label><label for="rad10000"><input type="radio" name="radius" id="rad10000" value="10000">10 km</label></div><span class="utility-header">Chọn loại tiện ích</span><div class="utilitylist"><label for="util4"><input type="checkbox" checked="checked" id="util4" value="4">Trường học</label><label for="util10"><input type="checkbox" id="util10" value="10">Dự án</label><label for="util5"><input type="checkbox" id="util5" value="5">Cơ sở y tế</label><label for="util3"><input type="checkbox" id="util3" value="3">Cơ quan hành chính</label><label for="util2"><input type="checkbox" checked="checked" id="util2" value="2">TT thể thao, giải trí</label><label for="util1"><input type="checkbox" checked="checked" id="util1" value="1">Địa điểm mua sắm</label><label for="util6"><input type="checkbox" id="util6" value="6">Bến xe, trạm xe</label><label for="util7"><input type="checkbox" id="util7" value="7">Công trình công cộng</label><label for="util0"><input type="checkbox" id="util0" value="0">Nhà hàng</label><label for="util8"><input type="checkbox" id="util8" value="8">Khách sạn</label><label for="util9"><input type="checkbox" id="util9" value="9">Tiện ích khác</label></div></div><div id="maputility"></div><div class="utilityResult"><div class="utilityResultHeader"></div><div class="utilityResultList"></div></div></div></div><div style="clear: both"></div>';b+='<div class="div-table"><div class="div-table-row"><div class="div-table-cell table1"><div class="div-hold"><div class="header">Đặc điểm bất động sản</div><div class="table-detail"><div class="row"><div class="left">Loại tin rao</div><div class="right">'+hdbProductCate.text()+'</div><div style="clear: both"></div></div><div class="row"><div class="left">Địa chỉ</div><div class="right">'+$("#txtAddress").val()+'</div><div style="clear: both"></div></div>';if($("#txtFloorNumbers").val().trim().length>0){b+='<div class="row"><div class="left">Số tầng</div><div class="right">'+$("#txtFloorNumbers").val()+'(tầng)</div><div style="clear: both"></div></div>'}if($("#txtRoomNumber").val().trim().length>0){b+='<div class="row"><div class="left">Số phòng ngủ</div><div class="right">'+$("#txtRoomNumber").val()+'(phòng)</div><div style="clear: both"></div></div>'}if($("#txtWidth").val().trim().length>0){b+='<div class="row"><div class="left">Mặt tiền</div><div class="right">'+$("#txtWidth").val()+'(m)</div><div style="clear: both"></div></div>'}if($("#txtLandWidth").val().trim().length>0){b+='<div class="row"><div class="left">Đường vào</div><div class="right">'+$("#txtLandWidth").val()+'(m)</div><div style="clear: both"></div></div>'}if($("#txtToiletNumber").val().trim().length>0){b+='<div class="row"><div class="left">Số toilet</div><div class="right">'+$("#txtToiletNumber").val()+'(m)</div><div style="clear: both"></div></div>'}if($("#txtInterior").val().trim().length>0){b+='<div class="row"><div class="left">Nội thất</div><div class="right">'+$("#txtInterior").val()+'</div><div style="clear: both"></div></div>'}if($("#ddlBaconDirection").val().trim().length>0){b+='<div class="row"><div class="left">Hướng ban công</div><div class="right">'+$("#ddlBaconDirection option:selected").text()+'</div><div style="clear: both"></div></div>'}if($("#ddlHomeDirection").val().trim().length>0){b+='<div class="row"><div class="left">Hướng nhà</div><div class="right">'+$("#ddlHomeDirection option:selected").text()+'</div><div style="clear: both"></div></div>'}b+="</div></div>";if(hdbProject.GetValue()>0){b+='<div id="project"><div class="header" style="margin-top: 15px; line-height: 29px;">Thông tin dự án<div class="inproject"><a  href="https://content.batdongsan.com.vn/%27+UnicodeToKoDauUrl(hdbProject.GetText())+"-pj"+hdbProject.GetValue()+'">Chi tiết dự án</a></div><div class="clear"></div></div><div class="table-detail"><div class="row"><div class="left">Tên dự án</div><div class="right">'+hdbProject.GetText()+'</div><div style="clear: both"></div></div></div></div>'}b+="</div>";b+='<div class="div-table-cell" style="width: 15px;"></div><div class="div-table-cell table2"><div class="header">Liên hệ</div><div class="table-detail"><div id="divCustomerInfo"><div class="right-content"><div class="normalblue left">Tên liên lạc</div><div class="right">'+$("#txtBrName").val()+'</div><div style="clear: both"></div></div><div class="right-content"><div class="normalblue left">Địa chỉ</div><div class="right">'+$("#txtBrAddress").val()+'</div><div style="clear: both"></div></div><div class="right-content"><div class="normalblue left">Điện thoại</div><div class="right">'+$("#txtBrPhone").val()+'</div><div style="clear: both"></div></div><div class="right-content"><div class="normalblue left">Mobile</div><div class="right">'+$("#txtBrMobile").val()+'</div><div style="clear: both"></div></div><div class="right-content"><div class="normalblue left">Email</div><div class="right">'+$("#txtBrEmail").val()+'</div><div style="clear: both"></div></div><div style="clear: both" id="divbreak"></div></div></div></div></div></div>';b+='<div class="prd-more-info"><div style="width: 220px"><span class="normalblue">Loại hình tin đăng:</span>'+$("#ddlVipType option:selected").text()+'</div><div style="width: 175px"><span class="normalblue">Ngày đăng:</span>'+$("#txtStartDate").val()+'</div><div><span class="normalblue">Ngày hết hạn:</span>'+$("#txtEndDate").val()+"</div></div>";b+='<div style="clear: both"></div></br>';b+='<input type="hidden" id="hdLat" value="'+$("#hddLatitude").val()+'">';b+='<input type="hidden" id="hdLong" value="'+$("#hddLongtitude").val()+'">';b+='<input type="hidden" id="hdAddress" value="'+$("#txtAddress").val()+'">';b+='<script src="https://content.batdongsan.com.vn/Modules/Product/Maps/Scripts/jquery.BlcokUI.js"></script>';b+='<script type="text/javascript" src="https://maps.google.com/maps/api/js?v=3.exp&amp;libraries=geometry&amp;key=AIzaSyBNRCC4yx2Bw3W3AXm1HtJHWQKBFCdqFOo&amp;language=vi"></script>';b+='<script src="https://content.batdongsan.com.vn/Scripts/jquery.scrollto.js" type="text/javascript"></script>';b+='<script src="https://content.batdongsan.com.vn/Scripts/ProductDetail.js?v=147" type="text/javascript"></script>';b+='<script>$("#photoSlide").ProductDetailGallery();';b+="var googleMapLink = 'https://maps.google.com/maps/api/js?v=3.exp&key="+googleMapLink+"';";b+="</script>";b+="</div></div></div>";f.window.document.write(b);f.window.document.close()}function SubmitForm(d){$("#hddVipType").val($("#ddlVipType").val());var b=false;focused=false;try{$("input[type=text]").each(function(){hideMessage(this);if($(this).val().indexOf(">")>=0||$(this).val().indexOf("<")>=0){showMessage(this,"Bạn không thể nhập vào ký tự &gt; hoặc &lt;");setFocus(this);b=true;return}if($(this).hasClass("required")==true){if($(this).val().length==0){showMessage(this,"Bạn cần nhập thông tin");setFocus(this);b=true;return}}if($(this).attr("maxlength")!=undefined){var i=parseInt($(this).attr("maxlength"));if(i<$(this).val().length){showMessage(this,"Số ký tự cần nhỏ hơn "+i);setFocus(this);b=true;return}}if($(this).attr("minlength")!=undefined){var k=parseInt($(this).attr("minlength"));if(k>$(this).val().length){showMessage(this,"Số ký tự cần lớn hơn "+k);setFocus(this);b=true;return}}if($(this).attr("minword")!=undefined){var l=parseInt($(this).attr("minword"));if(l>wordCount($(this).val())){showMessage(this,"Số ký từ nhỏ hơn "+l);setFocus(this);b=true;return}}if($(this).attr("maxword")!=undefined){var j=parseInt($(this).attr("maxword"));if(j<wordCount($(this).val())){showMessage(this,"Số ký từ lớn hơn "+j);setFocus(this);b=true;return}}if($(this).attr("email")!=undefined){var h=$(this).val();var n=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}(.[a-zA-Z]{2,6}){0,1}$/;if(h!=""){if(!n.test(h)){showMessage(this,"Vui lòng nhập Email");$(this).next().show();setFocus(this);b=true;return}}}if($(this).attr("numberonly")!=undefined&&$(this).val()!=""&&!($(this).is(":hidden"))){$(this).val($(this).val().trim());var m=/^\d+$/;if($(this).attr("numberonly")=="1"&&!m.test($(this).val())){showMessage(this,"Bạn cần nhập số.");setFocus(this);b=true;return}if($(this).attr("numberonly")=="2"&&(isNaN($(this).val())||!parseFloat($(this).val())>0)){showMessage(this,"Bạn cần nhập số.");setFocus(this);b=true;return}}});$("textarea").each(function(){hideMessage(this);if($(this).val().indexOf(">")>=0||$(this).val().indexOf("<")>=0){showMessage(this,"Bạn không thể nhập vào ký tự &gt; hoặc &lt;");setFocus(this);b=true;return}if($(this).hasClass("required")==true){if($(this).val()==""){showMessage(this,"Bạn cần nhập thông tin");setFocus(this);b=true;return}}if($(this).attr("maxlength")!=undefined){var h=parseInt($(this).attr("maxlength"));if(h<$(this).val().length){showMessage(this,"Số ký tự cần nhỏ hơn "+h);setFocus(this);b=true;return}}if($(this).attr("minlength")!=undefined){var j=parseInt($(this).attr("minlength"));if(j>$(this).val().length){showMessage(this,"số ký tự cần lớn hơn "+j);setFocus(this);b=true;return}}if($(this).attr("minword")!=undefined){var k=parseInt($(this).attr("minword"));if(k>wordCount($(this).val())){showMessage(this,"Số từ nhỏ hơn "+k);setFocus(this);b=true;return}}if($(this).attr("maxword")!=undefined){var i=parseInt($(this).attr("maxword"));if(i<wordCount($(this).val())){showMessage(this,"Số từ lớn hơn "+i);setFocus(this);b=true;return}}});$("select").each(function(){hideMessage(this);if($(this).hasClass("required")==true){if($(this).val()==null||$(this).val().length==0||$(this).val()=="0"){showMessage(this,"Bạn cần chọn thông tin");setFocus(this);b=true;return}}});if(hdbCity.GetValue()=="HN"&&hdbWard.GetValue()=="0"){showMessage($("#divWard"),"Bạn cần chọn thông tin");setFocus($("#divWard"));b=true}var f=mapCtrl.getLatLng();$("#hddLatitude").val(f.lat);$("#hddLongtitude").val(f.lng);if(mapCtrl.isMakerDrag){$("#hddIsMarkerDrag").val(1)}else{$("#hddIsMarkerDrag").val(0)}var g=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}(.[a-zA-Z]{2,6}){0,1}$/;var e=$("#chkReceiEmail").attr("checked");hideMessage($("#txtBrEmail"));if(e=="true"||e=="checked"){if($("#txtBrEmail").val().length>0){}else{showMessage($("#txtBrEmail"),"Bạn cần nhập Email");b=true;setFocus($("#txtBrEmail"))}}if($("#txtBrEmail").val().length>0){if(!g.test($("#txtBrEmail").val())){showMessage($("#txtBrEmail"),"Vui lòng nhập đúng định dạng Email");b=true;setFocus($("#txtBrEmail"))}}if($("#txtPrice").val().length==0){if($("#ddlPriceType").val()!="0"){setFocus($("#txtPrice"));$("#txtPrice").next().html("Bạn cần nhập giá");b=true}}else{if($("#ddlPriceType").val()=="0"){setFocus($("#ddlPriceType"));$("#txtPrice").next().html("Đ/v giá không được là Thỏa Thuận");b=true}}if($("#txtArea").val().length>0){var a=parseFloat($("#txtArea").val());if(a<=0){showMessage($("#txtArea"),"DT phải > 0");setFocus($("#txtArea"));b=true}}if($("#txtWidth").val().length>0){var a=parseFloat($("#txtWidth").val());if(a<=0){showMessage($("#txtWidth"),"Mặt tiền phải > 0");setFocus($("#txtWidth"));b=true}}if($("#txtLandWidth").val().length>0){var a=parseFloat($("#txtLandWidth").val());if(a<=0){showMessage($("#txtLandWidth"),"Đường vào phải > 0");setFocus($("#txtLandWidth"));b=true}}if($("#txtFloorNumbers").val().length>0){var a=parseFloat($("#txtFloorNumbers").val());if(a<=0){showMessage($("#txtFloorNumbers"),"Số tầng phải > 0");setFocus($("#txtFloorNumbers"));b=true}else{if(a>255){showMessage($("#txtFloorNumbers"),"Số tầng phải <= 255");setFocus($("#txtFloorNumbers"));b=true}}}if($("#txtRoomNumber").val().length>0){var a=parseFloat($("#txtRoomNumber").val());if(a<=0){showMessage($("#txtRoomNumber"),"Số phòng ngủ phải > 0");setFocus($("#txtRoomNumber"));b=true}else{if(a>255){showMessage($("#txtRoomNumber"),"Số phòng ngủ phải <= 255");setFocus($("#txtRoomNumber"));b=true}}}if($("#txtToiletNumber").val().length>0){var a=parseFloat($("#txtToiletNumber").val());if(a<=0){showMessage($("#txtToiletNumber"),"Số toilet phải > 0");setFocus($("#txtToiletNumber"));b=true}else{if(a>255){showMessage($("#txtToiletNumber"),"Số toilet phải <= 255");setFocus($("#txtToiletNumber"));b=true}}}if($("#txtBrPhone").val().length!=0&&$("#txtBrPhone").val().length<8){showMessage($("#txtBrPhone"),"Số ký tự không được nhỏ hơn 8");b=true;setFocus($("#txtBrPhone"))}$("#imgError").hide();if($("#ddlVipType").val()>=5&&$(".thumbnails .imgContainer").length>8){$("#imgError").show();$("#imgError .errorMessage").show();b=true;$.scrollTo("#imgError")}if(b==false&&mapCtrl.locationVerifyText!=null){$.scrollTo("#mapinfo");b=true;if(d){$.fancybox('<div><div style="text-align:center;">'+mapCtrl.locationVerifyText+'. Nếu quý khách chấp nhận xem trước chúng tôi sẽ điều chỉnh vị trí trên bản đồ về đúng địa chỉ được khai báo</div><div style="text-align:center; padding:20px;"><input style="margin:0px 10px;" class="bluebotton" type="button" value="Xem trước" onclick="confirmReSubmit(this, true)"/><input style="margin:0px 10px;" class="orangebutton" type="button" value="Quay lại" onclick="$.fancybox.close();"/></div></div>',{height:150,width:300,minWidth:300,maxWidth:300,minHeight:150,maxHeight:150})}else{$.fancybox('<div><div style="text-align:center;">'+mapCtrl.locationVerifyText+'. Nếu quý khách chấp nhận đăng tin chúng tôi sẽ điều chỉnh vị trí trên bản đồ về đúng địa chỉ được khai báo</div><div style="text-align:center; padding:20px;"><input style="margin:0px 10px;" class="bluebotton" type="button" value="Đăng tin" onclick="confirmReSubmit(this, false)"/><input style="margin:0px 10px;" class="orangebutton" type="button" value="Quay lại" onclick="$.fancybox.close();"/></div></div>',{height:150,width:300,minWidth:300,maxWidth:300,minHeight:150,maxHeight:150})}}if(b==true){$("#finalError").html("Có các thông tin bị lỗi!")}}catch(c){b=true}return b==false}function confirmReSubmit(b,e){$(b).parent().html("Đang thực hiện...");var a=[];var c=hdbCity.GetValue();var d=hdbDistrict.GetValue();var g=hdbStreet.GetValue();var h=hdbWard.GetValue();$("#hddIsMarkerDrag").val(0);if(hdbProject.GetValue()!=""&&hdbProject.GetValue()!="0"){$.fancybox.close();mapCtrl.reGetDefaultLocation(hdbProject.GetValue("lat"),hdbProject.GetValue("lng"),c,hdbCity.GetText(),d,hdbDistrict.GetText(),h,hdbWard.GetText(),g,function(){$.fancybox.close();$("#addWarning").html("");$("#addWarning").hide();if(e){$("#btnCancel").click()}else{$("#btnSave").click()}})}else{if(g!=""&&g!=0){a.push(hdbStreet.GetText())}if(h!=""&&h!=0){a.push(hdbWard.GetText())}if(d!=""&&d!=0){a.push(hdbDistrict.GetText())}if(c!=""&&c!=0){a.push(hdbCity.GetText())}a.push("Việt Nam");var f=e?window.open():null;mapCtrl.reGetDefaultLocation("","",c,hdbCity.GetText(),d,hdbDistrict.GetText(),h,hdbWard.GetText(),g,function(){$.fancybox.close();$("#addWarning").html("");$("#addWarning").hide();if(e){ShowPreview(f)}else{$("#btnSave").click()}})}}function resetLocation(){hdbWard.UpdateOptions('<li vl="0" class="advance-options">-- Phường/xã --</li>');hdbWard.SetValue(0);hdbStreet.UpdateOptions('<li vl="0" class="advance-options">-- Đường/phố --</li>');hdbStreet.SetValue(0);hdbProject.UpdateOptions('<li vl="0" class="advance-options">-- Dự án --</li>');hdbProject.SetValue(0)}function LoadAutoAddress(){if(hdbCity.GetValue()==""||hdbCity.GetValue()=="0"||hdbDistrict.GetValue()==""||hdbDistrict.GetValue()=="0"){$("#txtAddress").val("");return}var a=[];a.push(hdbCity.GetText());a.push(hdbDistrict.GetText());if(hdbProject.GetValue()!=""&&hdbProject.GetValue()!="0"){var b=hdbProject.GetText();if(b.toLowerCase().indexOf("dự án")!=0){a.push("Dự án "+b)}else{a.push(b)}}else{if(hdbWard.GetValue()!=""&&hdbWard.GetValue()!="0"){a.push(hdbWard.GetText())}if(hdbStreet.GetValue()!=""&&hdbStreet.GetValue()!="0"){a.push(hdbStreet.GetText())}}$("#txtAddress").val(a.reverse().join(", "))}function ShowLocation(){var a=[];var b=hdbCity.GetValue();var c=hdbDistrict.GetValue();var g=hdbStreet.GetValue();var h=hdbWard.GetValue();if(hdbProject.GetValue()!=""&&hdbProject.GetValue()!="0"){var f=hdbProject.GetText();if(f.toLowerCase().indexOf("dự án")!=0){f="Dự án "+f}a.push(f);if(c!=""&&c!=0){a.push(hdbDistrict.GetText())}if(b!=""&&b!=0){a.push(hdbCity.GetText())}a.push("Việt Nam");var d=hdbProject.GetValue("lat");var e=hdbProject.GetValue("lng");mapCtrl.showProjectLocation(d,e,a)}else{if(g!=""&&g!=0){a.push(hdbStreet.GetText())}if(h!=""&&h!=0){a.push(hdbWard.GetText())}if(c!=""&&c!=0){a.push(hdbDistrict.GetText())}if(b!=""&&b!=0){a.push(hdbCity.GetText())}a.push("Việt Nam");mapCtrl.showLocation(a,b,hdbCity.GetText(),c,hdbDistrict.GetText(),h,hdbWard.GetText(),g)}}function warningAddress(){var a=$("#txtAddress").val();if(a.length>0){var b=hdbCity.GetValue();var c=b!=null&&b!=""?hdbCity.GetText():null;var d=hdbDistrict.GetValue();var e=d!=null&&d!=""&&d>0?hdbDistrict.GetText():null;var k=hdbWard.GetValue();var l=k!=null&&k!=""&&k>0?hdbWard.GetText():null;var i=hdbStreet.GetValue();var j=i!=null&&i!=""&&i>0?hdbStreet.GetText():null;var g=hdbProject.GetValue();var h=g!=null&&g!=""&&g>0?hdbProject.GetText():null;var f=mapCtrl.verifyAddress(c,e,l,j,h,b,d,k,i,g,a);if(f!=null){$("#addWarning").html("Chú ý: "+f+"");$("#addWarning").show()}else{$("#addWarning").html("");$("#addWarning").hide()}}}function ShowMapToChangeLocation(){if($("#popup_map").length==0){var a='<div style="position: fixed; top: 0px; left: 0px; bottom:0px; right:0px; background: rgb(255, 255, 255); z-index: 10000;" id="popup_map"><div style="position:fixed; top:0px; left:0px; right:0px; bottom: 50px;"><div style="width:100%; height:100%;"  id="popup_map_canvas"></div></div><div style="padding:10px;position: fixed;z-index: 1000;width: 100%;height: auto;bottom: 0px;left: 0px;background: #fff;"><div style="float:left; padding-left: 20px;">kéo icon <img src="https://file4.batdongsan.com.vn/images/map-icon-detail.png" width="14" /> tới đúng vị trí của tin rao.</div><div style="float:right;"><input type="button" value="Đồng ý" onclick="ConfirmMapLocation()"/><a href="javascript:CancelMapLocationChange();" style="margin: 0px  50px;">Hủy</a></div></div></div>';$("body").append(a);mapCtrl.initialMap("popup_map_canvas")}else{$("#popup_map").show();mapCtrl.moveMapToCurrentLocation()}$("body").css("overview","hidden")}function ConfirmMapLocation(){mapCtrl.getAddress(true);$("#popup_map").hide();$("body").css("overview","none")}function CancelMapLocationChange(){$("#popup_map").hide();$("body").css("overview","none")}var mapCtrl=new function(){var a=this;a.map=undefined;a.marker=null;a.geocoder;a.infowindow=null;a.addressReturn=null;a.latlngReturn;a.isMakerDrag=false;a.latElement=null;a.lngElement=null;a.confirmMap=null;a.locationVerifyText=null;a._defaultLat="21.02894860978742";a._defaultLng="105.85244722590335";a.initialMap=function(b){var c=this.latElement.val();var d=this.lngElement.val();this.infowindow=new google.maps.InfoWindow();var f={zoom:14,scrollwheel:false,center:new google.maps.LatLng(c,d),mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(document.getElementById(b),f);var e=new google.maps.LatLng(c,d);this.marker=new google.maps.Marker({map:this.map,position:e,draggable:true});this.map.setCenter(e)};a.initialize=function(b,c){try{if(b===undefined||b.length==0||c===undefined||c.length==0){return}this.latElement=b;this.lngElement=c;if(this.latElement.val().length==0){this.latElement.val(this._defaultLat)}if(this.lngElement.val().length==0){this.lngElement.val(this._defaultLng)}var e=this.latElement.val();var f=this.lngElement.val();this.getAddress()}catch(d){throw d}};a.getAddress=function(b){try{var d,e;if(b){var f=this.marker.getPosition();d=f.lat();e=f.lng();this.latElement.val(d);this.lngElement.val(e)}else{var f=this.getLatLng();d=f.lat;e=f.lng}if(b!==undefined){this.isMakerDrag=b}this.confirmLocation(d,e)}catch(c){throw c}};a.getLatLng=function(){try{return{lat:this.latElement.val(),lng:this.lngElement.val()}}catch(b){throw b}};a.reGetDefaultLocation=function(g,h,c,d,e,f,j,k,i,b){this.isMakerDrag=false;if(this.marker!=null){this.marker.setMap(null)}this.locationVerifyText=null;if(g!=""&&h!=""&&g!=0&&h!=0){this.latElement.val(g);this.lngElement.val(h);$("#map_canvas").html('<iframe width="100%" height="100%" frameborder= "0" style= "border:0" src="https://www.google.com/maps/embed/v1/place?q='+g+","+h+"&key="+googleMapLink+'" allowfullscreen></iframe>');if(b!==undefined){b()}}else{$.post("https://apimap.batdongsan.com.vn/api/map_sync",{type:"getpoint",cityCode:c,districtId:e,wardId:j,streetId:i},function(l){if(l!=null){a.latElement.val(l.Lat);a.lngElement.val(l.Lng);a.confirmMap={CityCode:c,CityName:d,DistrictId:e,DistrictName:f,WardId:j,WardName:k};$("#map_canvas").html('<iframe width="100%" height="100%" frameborder= "0" style= "border:0" src="https://www.google.com/maps/embed/v1/place?q='+l.Lat+","+l.Lng+"&key="+googleMapLink+'" allowfullscreen></iframe>');if(b!==undefined){b()}}},"json")}};a.showProjectLocation=function(c,d,b){a.addressReturn=b.join(", ");if(c!=""&&d!=""&&c!=0&&d!=0){this.latElement.val(c);this.lngElement.val(d);this.confirmLocation(c,d)}};a.showLocation=function(b,c,d,e,f,i,j,h){if(b!=null&&b.length>0){if(this.marker!=null){this.marker.setMap(null)}try{if(typeof(b)=="object"){b=b.join(",")}}catch(g){return}a.isMakerDrag=false;$.post("https://apimap.batdongsan.com.vn/api/map_sync",{type:"getpoint",cityCode:c,districtId:e,wardId:i,streetId:h},function(k){if(k!=null){a.latElement.val(k.Lat);a.lngElement.val(k.Lng);a.confirmMap={CityCode:c,CityName:d,DistrictId:e,DistrictName:f,WardId:i,WardName:j};$("#map_canvas").html('<iframe width="100%" height="100%" frameborder= "0" style= "border:0" src="https://www.google.com/maps/embed/v1/place?q='+k.Lat+","+k.Lng+"&key="+googleMapLink+'" allowfullscreen></iframe>')}},"json")}else{}};a.moveMapToCurrentLocation=function(){var c=this.getLatLng();var b=new google.maps.LatLng(c.lat,c.lng);if(this.marker!=null){this.marker.setMap(null)}this.marker=new google.maps.Marker({map:this.map,position:b,draggable:true});this.map.setCenter(b)};a.confirmLocation=function(b,c){$.post("https://apimap.batdongsan.com.vn/api/map_sync",{type:"getward2",lat:b,lon:c},function(d){a.confirmMap=d;if(d!==undefined&&d!=null){$("#map_canvas").html('<iframe width="100%" height="100%" frameborder= "0" style= "border:0" src="https://www.google.com/maps/embed/v1/place?q='+b+","+c+"&key="+googleMapLink+'" allowfullscreen></iframe>');if(hdbProject.GetValue()!="0"&&hdbWard.GetValue()!="0"){if(d.WardId>0&&hdbWard.CheckValue(d.WardId)){hdbWard.SetValue(d.WardId)}else{a.confirmMap.WardId=hdbWard.GetValue()}}}warningAddress()},"json")};a.verifyAddress=function(d,f,l,j,h,c,e,k,i,g,b){d=UnicodeToKoDau(d);f=UnicodeToKoDau(f);l=UnicodeToKoDau(l);j=UnicodeToKoDau(j);h=UnicodeToKoDau(h);b=UnicodeToKoDau(b);this.locationVerifyText=null;if(this.confirmMap!=null){if(c!=null&&c!=""&&c!=this.confirmMap.CityCode){this.locationVerifyText="Vị trí trên bản đồ sai tỉnh/tp. bản đồ đang là: "+this.confirmMap.CityName}if(e!=null&&e>0&&e!=this.confirmMap.DistrictId){this.locationVerifyText="Vị trí trên bản đồ sai quận/huyện. bản đồ đang là: "+this.confirmMap.DistrictName}if(k!=null&&k!=""&&k!="0"){if(k!=this.confirmMap.WardId){this.locationVerifyText="Vị trí trên bản đồ sai phường/xã. bản đồ đang là: "+this.confirmMap.WardName}}}else{this.locationVerifyText="Không xác định được vị trí trên bản đồ"}return this.locationVerifyText};a.validateString=function(c,d){if(c==null||d==null||c===undefined||d===undefined||c.length==0||d.length==0){return true}var b=1;while(b<c.length){var e=c.substring(0,b);if(d.indexOf(e)>=0){b++}else{break}}return(b>(parseFloat(c.length)/2))}};$(document).ready(function(){if($("#pnlEdit").length==0){return}registerEventForBackMail();$(".countTypeLength").bind("keyup",function(){CountLimitChar($(this))});$(".countTypeLength").change(function(){CountLimitChar($(this),0,1)});$(".countTypeLength").bind("paste",function(l){var k=(l.originalEvent||l).clipboardData;CountLimitChar($(this),k.getData("text/plain").length)});mapCtrl.initialize($("#hddLatitude"),$("#hddLongtitude"));if(typeof cityListOTher1!="undefined"){cityList=$.merge(cityList,cityListOTher1)}if(typeof cityListOTher2!="undefined"){cityList=$.merge(cityList,cityListOTher2)}if(typeof cityListOTher3!="undefined"){cityList=$.merge(cityList,cityListOTher3)}if(typeof cityListOTher4!="undefined"){cityList=$.merge(cityList,cityListOTher4)}$(".errorMessage").hide();LoadProductType();LoadVipType();LoadDirection();LoadCity();hdbProductType.BindChangeEvent(hdbProductType,function(k){var l=k.GetValue();LoadProductCate(l);$("#hddProductCate").val("");$("#hddPriceType").val("");HideOptions()});hdbProductCate.BindChangeEvent(hdbProductCate,function(k){HideOptions()});hdbCity.BindChangeEvent(hdbCity,function(k){var l=k.GetValue();if(l=="HN"){$("#lblWard").show()}else{$("#lblWard").hide()}$("#hddCity").val(l);resetLocation();LoadDistrict(l);LoadAutoAddress();ShowLocation();GetAbsCost(1)});hdbDistrict.BindChangeEvent(hdbDistrict,function(k){var l=hdbCity.GetValue();var m=k.GetValue();resetLocation();LoadWard(l,m);LoadAutoAddress();ShowLocation();focusProjectByDesciption()});hdbWard.BindChangeEvent(hdbWard,function(k){LoadAutoAddress();ShowLocation()});hdbStreet.BindChangeEvent(hdbStreet,function(k){LoadAutoAddress();ShowLocation()});hdbProject.BindChangeEvent(hdbProject,function(k){hdbStreet.SetValue(k.GetValue("street"));hdbWard.SetValue(k.GetValue("ward"));LoadAutoAddress();ShowLocation()});$("#ddlVipType").change(function(){$("#hddVipType").val($("#ddlVipType").val());ResetEndDate();VipChange();GetAbsCost(1)});$("#txtStartDate").change(function(){ResetEndDate();GetAbsCost(2)});$("#txtEndDate").change(function(){ResetEndDate();GetAbsCost(2)});$("#txtStartDate").datepicker({dateFormat:"dd/mm/yy",minDate:new Date()});$("#txtStartDate").keypress(function(k){k.preventDefault()});$("#txtEndDate").datepicker({dateFormat:"dd/mm/yy"});$("#txtEndDate").keypress(function(k){k.preventDefault()});$("#ddlPriceType").change(function(){$("#txtPrice").next().html("");if($(this).val()=="0"){$("#txtPrice").val("")}else{if($("#txtPrice").val().length==0){$("#txtPrice").next().html("Bạn cần nhập giá")}}$("#hddPriceType").val($(this).val());setTotalRePrice()});$("#txtPrice").change(function(){$("#txtPrice").next().html("");if($(this).val().length==0){if($("#ddlPriceType").val()!="0"){$("#txtPrice").next().html("Bạn cần nhập giá")}}else{if($("#ddlPriceType").val()=="0"){$("#txtPrice").next().html("Đ/v giá không được là Thỏa Thuận")}}setTotalRePrice()});$("input[numbersonly=true]").each(function(){$(this).keydown(function(l){var k=$(this).attr("decimal")=="true";var m=numbersonly(this,l,k);if(m==false){l.preventDefault()}})});$("#txtArea").change(function(){setTotalRePrice()});$("#ddlBaconDirection").change(function(){$("#hddBaconDirection").val($(this).val())});$("#ddlHomeDirection").change(function(){$("#hddHomeDirection").val($(this).val())});$(".has-help").hover(function(){$(".helpMessage[rel="+$(this).attr("id")+"]").show()},function(){$(".helpMessage[rel="+$(this).attr("id")+"]").hide()});$("#txtProductTitle").on("input propertychange",function(){focusProjectByDesciption()});$("#txtDescription").on("input propertychange",function(){focusProjectByDesciption()});var f=hdbProductType.GetValue();var e=hdbProductCate.GetValue();if(f.length>0&&f!="0"){LoadProductCate(f);var h=$("#hddPriceType").val();if(h.length>0){$("#ddlPriceType").val(h)}}var b=hdbCity.GetValue();var j=hdbWard.GetValue();var g=hdbStreet.GetValue();var c=hdbDistrict.GetValue();if(b.length>0){LoadDistrict(b);if(c.length>0&&c!="0"){LoadWard(b,c);if(j.length>0&&j!="0"){hdbWard.SetValue(j)}if(g.length>0&&g!="0"){hdbStreet.SetValue(g)}}if($("#hddLatitude").val().length==0||$("#hddLongtitude").val().length==0){ShowLocation()}}var a=$("#hddBaconDirection").val();if(a.length>0){$("#ddlBaconDirection").val(a)}var d=$("#hddHomeDirection").val();if(d.length>0){$("#ddlHomeDirection").val(d)}var i=$("#hddVipType").val();if(i.length>0){$("#ddlVipType").val(i)}else{$("#ddlVipType").val(5)}ResetEndDate();GetAbsCost(2);$("#ddlVipType").trigger("change")});
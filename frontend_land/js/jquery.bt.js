jQuery.bt={version:"0.9.5-rc1"};(function(a){jQuery.fn.bt=function(f,n){if(typeof f!="string"){var g=true;n=f;f=false}else{var g=false}if(jQuery.fn.hoverIntent&&jQuery.bt.defaults.trigger=="hover"){jQuery.bt.defaults.trigger="hoverIntent"}return this.each(function(s){var t=jQuery.extend(false,jQuery.bt.defaults,jQuery.bt.options,n);t.spikeLength=m(t.spikeLength);t.spikeGirth=m(t.spikeGirth);t.overlap=m(t.overlap);var q=false;if(t.killTitle){a(this).find("[title]").andSelf().each(function(){if(!a(this).attr("bt-xTitle")){a(this).attr("bt-xTitle",a(this).attr("title")).attr("title","")}})}if(typeof t.trigger=="string"){t.trigger=[t.trigger]}if(t.trigger[0]=="hoverIntent"){var r=jQuery.extend(t.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}});a(this).hoverIntent(r)}else{if(t.trigger[0]=="hover"){a(this).hover(function(){this.btOn()},function(){this.btOff()})}else{if(t.trigger[0]=="now"){if(a(this).hasClass("bt-active")){this.btOff()}else{this.btOn()}}else{if(t.trigger[0]=="none"){}else{if(t.trigger.length>1&&t.trigger[0]!=t.trigger[1]){a(this).bind(t.trigger[0],function(){this.btOn()}).bind(t.trigger[1],function(){this.btOff()})}else{a(this).bind(t.trigger[0],function(){if(a(this).hasClass("bt-active")){this.btOff()}else{this.btOn()}})}}}}}this.btOn=function(){if(typeof a(this).data("bt-box")=="object"){this.btOff()}t.preBuild.apply(this);a(jQuery.bt.vars.closeWhenOpenStack).btOff();a(this).addClass("bt-active "+t.activeClass);if(g&&t.ajaxPath==null){if(t.killTitle){a(this).attr("title",a(this).attr("bt-xTitle"))}f=a.isFunction(t.contentSelector)?t.contentSelector.apply(this):eval(t.contentSelector);if(t.killTitle){a(this).attr("title","")}}if(t.ajaxPath!=null&&f==false){if(typeof t.ajaxPath=="object"){var av=eval(t.ajaxPath[0]);av+=t.ajaxPath[1]?" "+t.ajaxPath[1]:""}else{var av=t.ajaxPath}var M=av.indexOf(" ");if(M>=0){var Y=av.slice(M,av.length);av=av.slice(0,M)}var z=t.ajaxCache?a(document.body).data("btCache-"+av.replace(/\./g,"")):null;if(typeof z=="string"){f=Y?a("<div/>").append(z.replace(/<script(.|\s)*?\/script>/g,"")).find(Y):z}else{var ag=this;var y=jQuery.extend(false,{type:t.ajaxType,data:t.ajaxData,cache:t.ajaxCache,url:av,complete:function(aD,x){if(x=="success"||x=="notmodified"){if(t.ajaxCache){a(document.body).data("btCache-"+av.replace(/\./g,""),aD.responseText)}q=false;f=Y?a("<div/>").append(aD.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(Y):aD.responseText}else{if(x=="timeout"){q=true}f=t.ajaxError.replace(/%error/g,aD.statusText)}if(a(ag).hasClass("bt-active")){ag.btOn()}}},t.ajaxOpts);jQuery.ajax(y);f=t.ajaxLoading}}var Z=0;var aa=0;var ac=0;var ad=0;if(t.shadow&&!p()){t.shadow=false;jQuery.extend(t,t.noShadowOpts)}if(t.shadow){if(t.shadowBlur>Math.abs(t.shadowOffsetX)){Z=t.shadowBlur*2}else{Z=t.shadowBlur+Math.abs(t.shadowOffsetX)}ac=(t.shadowBlur-t.shadowOffsetX)>0?t.shadowBlur-t.shadowOffsetX:0;if(t.shadowBlur>Math.abs(t.shadowOffsetY)){aa=t.shadowBlur*2}else{aa=t.shadowBlur+Math.abs(t.shadowOffsetY)}ad=(t.shadowBlur-t.shadowOffsetY)>0?t.shadowBlur-t.shadowOffsetY:0}if(t.offsetParent){var N=a(t.offsetParent);var O=N.offset();var U=a(this).offset();var au=m(U.top)-m(O.top)+m(a(this).css("margin-top"))-ad;var J=m(U.left)-m(O.left)+m(a(this).css("margin-left"))-ac}else{var N=(a(this).css("position")=="absolute")?a(this).parents().eq(0).offsetParent():a(this).offsetParent();var U=a(this).btPosition();var au=m(U.top)+m(a(this).css("margin-top"))-ad;var J=m(U.left)+m(a(this).css("margin-left"))-ac}var ax=a(this).btOuterWidth();var G=a(this).outerHeight();if(typeof f=="object"){var Q=f;var B=a(Q).clone(true).show();var P=a(Q).data("bt-clones")||[];P.push(B);a(Q).data("bt-clones",P);a(B).data("bt-orig",Q);a(this).data("bt-content-orig",{original:Q,clone:B});f=B}if(typeof f=="null"||f==""){return}var w=a('<div class="bt-content"></div>').append(f).css({padding:t.padding,position:"absolute",width:(t.shrinkToFit?"auto":t.width),zIndex:t.textzIndex,left:ac,top:ad}).css(t.cssStyles);var v=a('<div class="bt-wrapper"></div>').append(w).addClass(t.cssClass).css({position:"absolute",width:t.width,zIndex:t.wrapperzIndex,visibility:"hidden"}).appendTo(N);if(jQuery.fn.bgiframe){w.bgiframe();v.bgiframe()}a(this).data("bt-box",v);var X=m(a(document).scrollTop());var W=m(a(document).scrollLeft());var F=m(a(window).width());var E=m(a(window).height());var az=W+F;var ay=X+E;var ae=new Object();var at=a(this).offset();ae.top=at.top-X;ae.bottom=E-((at+G)-X);ae.left=at.left-W;ae.right=F-((at.left+ax)-W);var am=m(w.outerHeight());var an=m(w.btOuterWidth());if(t.positions.constructor==String){t.positions=t.positions.replace(/ /,"").split(",")}if(t.positions[0]=="most"){var V="top";for(var S in ae){V=ae[S]>ae[V]?S:V}}else{for(var aA in t.positions){var V=t.positions[aA];if((V=="left"||V=="right")&&ae[V]>an+t.spikeLength){break}else{if((V=="top"||V=="bottom")&&ae[V]>am+t.spikeLength){break}}}}var H=J+((ax-an)*0.5);var aw=au+((G-am)*0.5);var T=new Array();var aq,ak,ao,ah,ar,ai,al,ap,C,aj,af;switch(V){case"top":w.css("margin-bottom",t.spikeLength+"px");v.css({top:(au-w.outerHeight(true))+t.overlap,left:H});ap=(az-t.windowMargin)-(w.offset().left+w.btOuterWidth(true));var aB=ac;if(ap<0){v.css("left",(m(v.css("left"))+ap)+"px");aB-=ap}al=(w.offset().left+m(w.css("margin-left")))-(W+t.windowMargin);if(al<0){v.css("left",(m(v.css("left"))-al)+"px");aB+=al}aq=w.btPosition().top+m(w.css("margin-top"));ak=w.btPosition().left+m(w.css("margin-left"));ao=ak+w.btOuterWidth();ah=aq+w.outerHeight();aj={x:ak+(w.btOuterWidth()*t.centerPointX),y:aq+(w.outerHeight()*t.centerPointY)};T[T.length]=af={y:ah+t.spikeLength,x:((ao-ak)*0.5)+aB,type:"spike"};C=k(af.x,af.y,aj.x,aj.y,ah);C.x=C.x<ak+t.spikeGirth/2+t.cornerRadius?ak+t.spikeGirth/2+t.cornerRadius:C.x;C.x=C.x>(ao-t.spikeGirth/2)-t.cornerRadius?(ao-t.spikeGirth/2)-t.CornerRadius:C.x;T[T.length]={x:C.x-(t.spikeGirth/2),y:ah,type:"join"};T[T.length]={x:ak,y:ah,type:"corner"};T[T.length]={x:ak,y:aq,type:"corner"};T[T.length]={x:ao,y:aq,type:"corner"};T[T.length]={x:ao,y:ah,type:"corner"};T[T.length]={x:C.x+(t.spikeGirth/2),y:ah,type:"join"};T[T.length]=af;break;case"left":w.css("margin-right",t.spikeLength+"px");v.css({top:aw+"px",left:((J-w.btOuterWidth(true))+t.overlap)+"px"});ai=(ay-t.windowMargin)-(w.offset().top+w.outerHeight(true));var aC=ad;if(ai<0){v.css("top",(m(v.css("top"))+ai)+"px");aC-=ai}ar=(w.offset().top+m(w.css("margin-top")))-(X+t.windowMargin);if(ar<0){v.css("top",(m(v.css("top"))-ar)+"px");aC+=ar}aq=w.btPosition().top+m(w.css("margin-top"));ak=w.btPosition().left+m(w.css("margin-left"));ao=ak+w.btOuterWidth();ah=aq+w.outerHeight();aj={x:ak+(w.btOuterWidth()*t.centerPointX),y:aq+(w.outerHeight()*t.centerPointY)};T[T.length]=af={x:ao+t.spikeLength,y:((ah-aq)*0.5)+aC,type:"spike"};C=l(af.x,af.y,aj.x,aj.y,ao);C.y=C.y<aq+t.spikeGirth/2+t.cornerRadius?aq+t.spikeGirth/2+t.cornerRadius:C.y;C.y=C.y>(ah-t.spikeGirth/2)-t.cornerRadius?(ah-t.spikeGirth/2)-t.cornerRadius:C.y;T[T.length]={x:ao,y:C.y+t.spikeGirth/2,type:"join"};T[T.length]={x:ao,y:ah,type:"corner"};T[T.length]={x:ak,y:ah,type:"corner"};T[T.length]={x:ak,y:aq,type:"corner"};T[T.length]={x:ao,y:aq,type:"corner"};T[T.length]={x:ao,y:C.y-t.spikeGirth/2,type:"join"};T[T.length]=af;break;case"bottom":w.css("margin-top",t.spikeLength+"px");v.css({top:(au+G)-t.overlap,left:H});ap=(az-t.windowMargin)-(w.offset().left+w.btOuterWidth(true));var aB=ac;if(ap<0){v.css("left",(m(v.css("left"))+ap)+"px");aB-=ap}al=(w.offset().left+m(w.css("margin-left")))-(W+t.windowMargin);if(al<0){v.css("left",(m(v.css("left"))-al)+"px");aB+=al}aq=w.btPosition().top+m(w.css("margin-top"));ak=w.btPosition().left+m(w.css("margin-left"));ao=ak+w.btOuterWidth();ah=aq+w.outerHeight();aj={x:ak+(w.btOuterWidth()*t.centerPointX),y:aq+(w.outerHeight()*t.centerPointY)};T[T.length]=af={x:((ao-ak)*0.5)+aB,y:ad,type:"spike"};C=k(af.x,af.y,aj.x,aj.y,aq);C.x=C.x<ak+t.spikeGirth/2+t.cornerRadius?ak+t.spikeGirth/2+t.cornerRadius:C.x;C.x=C.x>(ao-t.spikeGirth/2)-t.cornerRadius?(ao-t.spikeGirth/2)-t.cornerRadius:C.x;T[T.length]={x:C.x+t.spikeGirth/2,y:aq,type:"join"};T[T.length]={x:ao,y:aq,type:"corner"};T[T.length]={x:ao,y:ah,type:"corner"};T[T.length]={x:ak,y:ah,type:"corner"};T[T.length]={x:ak,y:aq,type:"corner"};T[T.length]={x:C.x-(t.spikeGirth/2),y:aq,type:"join"};T[T.length]=af;break;case"right":w.css("margin-left",(t.spikeLength+"px"));v.css({top:aw+"px",left:((J+ax)-t.overlap)+"px"});ai=(ay-t.windowMargin)-(w.offset().top+w.outerHeight(true));var aC=ad;if(ai<0){v.css("top",(m(v.css("top"))+ai)+"px");aC-=ai}ar=(w.offset().top+m(w.css("margin-top")))-(X+t.windowMargin);if(ar<0){v.css("top",(m(v.css("top"))-ar)+"px");aC+=ar}aq=w.btPosition().top+m(w.css("margin-top"));ak=w.btPosition().left+m(w.css("margin-left"));ao=ak+w.btOuterWidth();ah=aq+w.outerHeight();aj={x:ak+(w.btOuterWidth()*t.centerPointX),y:aq+(w.outerHeight()*t.centerPointY)};T[T.length]=af={x:ac,y:((ah-aq)*0.5)+aC,type:"spike"};C=l(af.x,af.y,aj.x,aj.y,ak);C.y=C.y<aq+t.spikeGirth/2+t.cornerRadius?aq+t.spikeGirth/2+t.cornerRadius:C.y;C.y=C.y>(ah-t.spikeGirth/2)-t.cornerRadius?(ah-t.spikeGirth/2)-t.cornerRadius:C.y;T[T.length]={x:ak,y:C.y-t.spikeGirth/2,type:"join"};T[T.length]={x:ak,y:aq,type:"corner"};T[T.length]={x:ao,y:aq,type:"corner"};T[T.length]={x:ao,y:ah,type:"corner"};T[T.length]={x:ak,y:ah,type:"corner"};T[T.length]={x:ak,y:C.y+t.spikeGirth/2,type:"join"};T[T.length]=af;break}var A=document.createElement("canvas");a(A).attr("width",(m(w.btOuterWidth(true))+t.strokeWidth*2+Z)).attr("height",(m(w.outerHeight(true))+t.strokeWidth*2+aa)).appendTo(v).css({position:"absolute",zIndex:t.boxzIndex});if(typeof G_vmlCanvasManager!="undefined"){A=G_vmlCanvasManager.initElement(A)}if(t.cornerRadius>0){var L=new Array();var K;for(var I=0;I<T.length;I++){if(T[I].type=="corner"){K=c(T[I],T[(I-1)%T.length],t.cornerRadius);K.type="arcStart";L[L.length]=K;L[L.length]=T[I];K=c(T[I],T[(I+1)%T.length],t.cornerRadius);K.type="arcEnd";L[L.length]=K}else{L[L.length]=T[I]}}T=L}var D=A.getContext("2d");if(t.shadow&&t.shadowOverlap!==true){var ab=m(t.shadowOverlap);switch(V){case"top":if(t.shadowOffsetX+t.shadowBlur-ab>0){v.css("top",(m(v.css("top"))-(t.shadowOffsetX+t.shadowBlur-ab)))}break;case"right":if(ac-ab>0){v.css("left",(m(v.css("left"))+ac-ab))}break;case"bottom":if(ad-ab>0){v.css("top",(m(v.css("top"))+ad-ab))}break;case"left":if(t.shadowOffsetY+t.shadowBlur-ab>0){v.css("left",(m(v.css("left"))-(t.shadowOffsetY+t.shadowBlur-ab)))}break}}h.apply(D,[T],t.strokeWidth);D.fillStyle=t.fill;if(t.shadow){D.shadowOffsetX=t.shadowOffsetX;D.shadowOffsetY=t.shadowOffsetY;D.shadowBlur=t.shadowBlur;D.shadowColor=t.shadowColor}D.closePath();D.fill();if(t.strokeWidth>0){D.shadowColor="rgba(0, 0, 0, 0)";D.lineWidth=t.strokeWidth;D.strokeStyle=t.strokeStyle;D.beginPath();h.apply(D,[T],t.strokeWidth);D.closePath();D.stroke()}t.preShow.apply(this,[v[0]]);v.css({display:"none",visibility:"visible"});t.showTip.apply(this,[v[0]]);if(t.overlay){var R=a('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:au,left:J,width:ax,height:G,opacity:".2"}).appendTo(N);a(this).data("overlay",R)}if((t.ajaxPath!=null&&t.ajaxCache==false)||q){f=false}if(t.clickAnywhereToClose){jQuery.bt.vars.clickAnywhereStack.push(this);a(document).click(jQuery.bt.docClick)}if(t.closeWhenOthersOpen){jQuery.bt.vars.closeWhenOpenStack.push(this)}t.postShow.apply(this,[v[0]])};this.btOff=function(){var v=a(this).data("bt-box");t.preHide.apply(this,[v]);var w=this;w.btCleanup=function(){var x=a(w).data("bt-box");var z=a(w).data("bt-content-orig");var A=a(w).data("bt-overlay");if(typeof x=="object"){a(x).remove();a(w).removeData("bt-box")}if(typeof z=="object"){var y=a(z.original).data("bt-clones");a(z).data("bt-clones",b(y,z.clone))}if(typeof A=="object"){a(A).remove();a(w).removeData("bt-overlay")}jQuery.bt.vars.clickAnywhereStack=b(jQuery.bt.vars.clickAnywhereStack,w);jQuery.bt.vars.closeWhenOpenStack=b(jQuery.bt.vars.closeWhenOpenStack,w);a(w).removeClass("bt-active "+t.activeClass);t.postHide.apply(w)};t.hideTip.apply(this,[v,w.btCleanup])};var u=this.btRefresh=function(){this.btOff();this.btOn()}});function h(q,r){this.moveTo(q[0].x,q[0].y);for(i=1;i<q.length;i++){if(q[i-1].type=="arcStart"){this.quadraticCurveTo(o(q[i].x,r),o(q[i].y,r),o(q[(i+1)%q.length].x,r),o(q[(i+1)%q.length].y,r));i++}else{this.lineTo(o(q[i].x,r),o(q[i].y,r))}}}function o(q,s){var r;s=m(s);if(s%2){r=q}else{r=Math.round(q-0.5)+0.5}return r}function m(q){return parseInt(q)||0}function b(q,r){var t,s=new Array();for(t in q){if(q[t]!=r){s.push(q[t])}}return s}function d(){var q=false;try{q=!!(document.createElement("canvas").getContext("2d"))}catch(r){q=!!(document.createElement("canvas").getContext)}return q}function p(){try{var r=navigator.userAgent.toLowerCase();if(/webkit/.test(r)){return true}else{if(/gecko|mozilla/.test(r)&&parseFloat(r.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1){return true}}}catch(q){}return false}function c(r,s,q){var u,t;if(r.x==s.x){u=r.y<s.y?r.y+q:r.y-q;return{x:r.x,y:u}}else{if(r.y==s.y){t=r.x<s.x?r.x+q:r.x-q;return{x:t,y:r.y}}}}function e(r,s,q){var v=s.x==r.x?q.x:r.x;var w=s.y==r.y?q.y:r.y;var u,t;if(r.x<q.x){if(r.y>q.y){u=(Math.PI/180)*180;t=(Math.PI/180)*90}else{u=(Math.PI/180)*90;t=0}}else{if(r.y>q.y){u=(Math.PI/180)*270;t=(Math.PI/180)*180}else{u=0;t=(Math.PI/180)*270}}return{x:v,y:w,type:"center",startAngle:u,endAngle:t}}function j(s,u,t,v,A,C,B,D){if(A==B){return l(s,u,t,v,A)}if(C==D){return k(s,u,t,v,C)}var r=(u-v)/(s-t);var q=u-(r*s);var z=(C-D)/(A-B);var w=C-(z*A);var E=(w-q)/(r-z);var F=r*E+q;return{x:E,y:F}}function l(s,u,t,v,w){if(u==v){return{x:w,y:u}}var r=(u-v)/(s-t);var q=u-(r*s);var z=r*w+q;return{x:w,y:z}}function k(s,u,t,v,z){if(s==t){return{x:s,y:z}}var r=(u-v)/(s-t);var q=u-(r*s);var w=(z-q)/r;return{x:w,y:z}}};jQuery.fn.btPosition=function(){function c(j,k){return j[0]&&parseInt(jQuery.css(j[0],k,true),10)||0}var b=0,h=0,g;if(this[0]){var e=this.offsetParent(),d=this.offset(),f=/^body|html$/i.test(e[0].tagName)?{top:0,left:0}:e.offset();d.top-=c(this,"marginTop");d.left-=c(this,"marginLeft");f.top+=c(e,"borderTopWidth");f.left+=c(e,"borderLeftWidth");g={top:d.top-f.top,left:d.left-f.left}}return g};jQuery.fn.btOuterWidth=function(b){function c(d,e){return d[0]&&parseInt(jQuery.css(d[0],e,true),10)||0}return this["innerWidth"]()+c(this,"borderLeftWidth")+c(this,"borderRightWidth")+(b?c(this,"marginLeft")+c(this,"marginRight"):0)};jQuery.fn.btOn=function(){return this.each(function(b){if(jQuery.isFunction(this.btOn)){this.btOn()}})};jQuery.fn.btOff=function(){return this.each(function(b){if(jQuery.isFunction(this.btOff)){this.btOff()}})};jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]};jQuery.bt.docClick=function(b){if(!b){var b=window.event}if(!a(b.target).parents().andSelf().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length){a(jQuery.bt.vars.clickAnywhereStack).btOff();a(document).unbind("click",jQuery.bt.docClick)}};jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:true,closeWhenOthersOpen:false,shrinkToFit:false,width:"200px",padding:"5px",spikeGirth:10,spikeLength:15,overlap:0,overlay:false,killTitle:true,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:0.5,centerPointY:0.5,shadow:false,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:false,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",contentSelector:"$(this).attr('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:true,ajaxOpts:{},preBuild:function(){},preShow:function(b){},showTip:function(b){a(b).show()},postShow:function(b){},preHide:function(b){},hideTip:function(b,c){a(b).hide();c()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}};jQuery.bt.options={}})(jQuery);
___isIE=/MSIE (\d+\.\d+);/.test(navigator.userAgent);if(___isIE){var defaultText=$("#txtAutoComplete").attr("placeholder");$("#txtAutoComplete").css("color","#777");$("#txtAutoComplete").css("height","19px");$("#txtAutoComplete").css("padding-top","2px");$("#txtAutoComplete").css("padding-bottom","2px");$("#txtAutoComplete").css("line-height","18px");if($("#txtAutoComplete").val().length==0){$("#txtAutoComplete").val(defaultText)}$("#txtAutoComplete").blur(function(){if($("#txtAutoComplete").val().length==0){$("#txtAutoComplete").val(defaultText)}});$("#txtAutoComplete").focus(function(){if($("#txtAutoComplete").val()==defaultText){$("#txtAutoComplete").val("")}})}var topSearch=undefined;$(document).ready(function(){$.ui.autocomplete.prototype._renderItem=function(e,a){var d=this.term.split(" ").join("|");var b=new RegExp("("+d+")","gi");var c=a.label.replace(b,"<b>$1</b>");return $("<li class='bdsautocomplete'>").data("item.autocomplete",a).append("<a>"+c+"</a>").appendTo(e)};topSearch=new function(){var a=this;this.hdbCategory=$("#divCategory").AdvanceHiddenDropbox({id:"divCatagoryOptions",hddValue:"hdCategory"});this.hdbCity=$("#divCity").AdvanceHiddenDropbox({id:"divCityOptions",hddValue:"hdCity"});this.hdbDistrict=$("#divDistrict").AdvanceHiddenDropbox({id:"divDistrictOptions",hddValue:"hdDistrict"});this.hdbPrice=$("#divPrice").AdvanceHiddenDropbox({id:"divPriceOptions",minValue:"txtPriceMinValue",maxValue:"txtPriceMaxValue",unit:"money",lblMin:"lblPriceMin",lblMax:"lblPriceMax",hddValue:"hdCboPrice"});this.hdbCity.BindChangeEvent(this,function(b){b.changeCityHandler();b.textSearch.val("");$("#hddProjectId").val("")});this.hdbCategory.BindChangeEvent(this,function(b){b.textSearch.val("");$("#hddProjectId").val("");var c=b.hdbCategory.GetValue();if(c=="0"){$("#explandctl").trigger("click");addErrorMessage($("#searchcontrol"),"Bạn cần chọn loại dự án");return false}else{removeErrorMessage($("#searchcontrol"))}});this.hdbDistrict.BindChangeEvent(this,function(b){b.textSearch.val("");$("#hddProjectId").val("")});this.changeCityHandler=function(){var c=this.hdbCity.GetValue();var b="";b+='<li vl="0" class="advance-options">Quận huyện</li>';if(c!="CN"){$.each(districtList,function(d,e){if(e.code==c){b+='<li vl="'+e.id+'" class="advance-options">'+e.name+"</li>"}})}this.hdbDistrict.UpdateOptions(b);this.hdbDistrict.SetValue(0)};this.SubmitSearch=function(c){var d=c||window.event;try{var b=this.hdbCategory.GetValue();try{var i=/(<([^>]+)>)/ig;var g=this.textSearch.val().replace(i,"").trim();g=g.replace(/(  )+?/g,"");g=UnicodeToKoDau(g,true);$("#hdKeyword").val(g);this.textSearch.val(g)}catch(f){return false}var h=this.textSearch.val().length;var j=false;if(h==0){if(b<=0){}else{j=true}}else{if(b>0){j=true}else{j=this.hdbCity.GetValue().length==0||this.hdbCity.GetValue()=="CN"}}if(j==false){$("#explandctl").trigger("click");if(d!==undefined){d.preventDefault();d.stopPropagation();this.hdbCategory.ShowOptions()}else{window.setTimeout(function(){topSearch.hdbCategory.ShowOptions()},100)}return false}else{removeErrorMessage($("#searchcontrol"))}$("form").attr("action","/HandlerWeb/ProjectHandler.ashx?type=redirect");$("form").submit();return true}catch(f){alert(f.message);throw f;return true}};this.textSearch=$("#txtAutoComplete");this.textSearch.bind("keydown",function(b){var c=b||window.event;if(c.which==13){return false}});this.textSearch.bind("focus",function(b){$(this).attr("placeholder","")});this.textSearch.bind("blur",function(b){$(this).attr("placeholder","Nhập từ khóa tìm kiếm (ví dụ: dự án quận Hà Đông)")});this.textSearch.autocomplete({source:function(e,f){var d=/(<([^>]+)>)/ig;var g=e.term.replace(d,"").trim();g=g.replace(/(  )+?/g,"");g=UnicodeToKoDau(g,true).trim();a.hdbCategory.SetValue(0);a.hdbCity.SetValue(0);a.hdbDistrict.SetValue(0);a.hdbPrice.SetValue(-1);$("#hddProjectId").val(0);$("#hdKeyword").val(g);if(g.length<3){return}var b=null;if(JSON!=undefined&&localStorage!=undefined){b=JSON.parse(localStorage.getItem("suggestion-cache"))}if(b==null){b=[{}]}var c=b[g];if(c!=null){f(c);return}else{var h;if(new Date().getSeconds()%2==0){h="https://suggestion1.batdongsan.com.vn/"}else{h="https://suggestion2.batdongsan.com.vn/"}cnt=0;$.ajax({url:h+g,success:function(i){b[g]=i;if(localStorage!=undefined){localStorage.setItem("suggestion-cache",JSON.stringify(b))}f(i)}})}},minLength:2,select:function(b,d){var c=d.item.id;a.hdbCategory.SetValue(c.projcate);a.hdbCity.SetValue(c.city);a.changeCityHandler();a.hdbDistrict.SetValue(c.distr);$("#hddProjectId").val(c.projid);$("#hdKeyword").val("");var e;if(new Date().getSeconds()%2==0){e="https://suggestion1.batdongsan.com.vn/"}else{e="https://suggestion2.batdongsan.com.vn/"}$.post(e+c.id)},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})}});function addErrorMessage(d,c){var a="";var b=$(d).attr("id");a+='<div id="validateFor'+b+'" class="error-message">';a+=c;a+="</div>";if(!$("#validateFor"+b).length){$(d).after(a);$(d).removeClass("input-ok-field");$(d).addClass("input-error-field")}else{$("#validateFor"+b).remove();$(d).after(a);$(d).removeClass("input-ok-field");$(d).addClass("input-error-field")}}function removeErrorMessage(b){var a=$(b).attr("id");if($("#validateFor"+a).length){$("#validateFor"+a).remove();$(b).removeClass("input-error-field");$(b).addClass("input-ok-field")}};